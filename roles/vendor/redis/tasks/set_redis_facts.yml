- name: Ansible collector
  setup:
    filter: 'ansible_memtotal_mb'

- name: Set mem for single redis
  set_fact:
    redis_mem: "{{ ((ansible_memtotal_mb*(redis_maxmem/100))*1024*1024)|int }}"
  when: redis_cluster == false

# hardcoded for having 2 logical nodes on 1 host
- name: Set mem for redis cluster
  set_fact:
    redis_mem: "{{ (((ansible_memtotal_mb*(redis_maxmem/100))/2)*1024*1024)|int }}"
  when: redis_cluster == true